(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[287],{6534:(e,r,a)=>{Promise.resolve().then(a.bind(a,1372))},8725:(e,r,a)=>{"use strict";a.d(r,{_:()=>n,u:()=>l});var t=a(5155),o=a(2115),c=a(5838);let s=(0,o.createContext)(),l=()=>{let e=(0,o.useContext)(s);if(!e)throw Error("useCarrito debe ser usado dentro de un CarritoProvider");return e},n=e=>{let{children:r}=e,[a,l]=(0,o.useState)([]),[n,i]=(0,o.useState)(!1),[d,m]=(0,o.useState)(null),[h,u]=(0,o.useState)(0),[x,p]=(0,o.useState)(null);(0,o.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("carritoId"),r=localStorage.getItem("carritoItems");if(e){if(p(parseInt(e)),r)try{let e=JSON.parse(r);l(e);let a=e.reduce((e,r)=>e+(r.total||0),0);u(a)}catch(e){console.error("Error al parsear items del localStorage:",e),l([]),u(0)}else try{await g(parseInt(e))}catch(e){console.error("Error al cargar items del servidor:",e),l([]),u(0)}}else{let e=Date.now();p(e),localStorage.setItem("carritoId",e.toString()),l([]),u(0)}}catch(r){console.error("Error al inicializar el carrito:",r);let e=Date.now();p(e),localStorage.setItem("carritoId",e.toString()),l([]),u(0)}})()},[]);let g=async e=>{if(e)try{i(!0);try{var r,a;let t=await c.Ay.get("/detalles/carrito/".concat(e));l(t.data||[]);try{let a=await c.Ay.get("/detalles/carrito/".concat(e,"/total"));u((null===(r=a.data)||void 0===r?void 0:r.total)||0)}catch(r){console.error("Error al obtener el total del carrito:",r);let e=(null===(a=t.data)||void 0===a?void 0:a.reduce((e,r)=>e+(r.total||0),0))||0;u(e)}m(null)}catch(r){console.error("Error al cargar items del carrito:",r);let e=localStorage.getItem("carritoItems");if(e)try{let r=JSON.parse(e);l(r);let a=r.reduce((e,r)=>e+(r.total||0),0);u(a)}catch(e){console.error("Error al parsear items del localStorage:",e),l([]),u(0)}else l([]),u(0);m("No se pudieron cargar los productos del carrito")}}finally{i(!1)}},y=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;try{i(!0);let t=a.find(r=>r.id_producto===e.id_producto);if(t){let e=t.cantidad+r;await f(t.id_detalle_carrito,e);return}let o={id_detalle_carrito:Date.now(),id_carrito:x,id_producto:e.id_producto,cantidad:r,precio_unitario:e.precio_oferta||e.precio,total:(e.precio_oferta||e.precio)*r,nombre:e.nombre,imagen:e.imagen,marca_nombre:e.marca_nombre||e.marca},c=[...a,o];l(c);let s=h+o.total;return u(s),localStorage.setItem("carritoItems",JSON.stringify(c)),o}catch(e){throw console.error("Error al agregar producto al carrito:",e),m("No se pudo agregar el producto al carrito"),e}finally{i(!1)}},f=async(e,r)=>{if(x)try{i(!0);let a=await c.Ay.put("/detalles/".concat(e),{cantidad:r});return await g(x),a.data}catch(e){var a,t;throw console.error("Error al actualizar cantidad del producto:",e),m((null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.error)||"No se pudo actualizar la cantidad del producto"),e}finally{i(!1)}},b=async e=>{if(x)try{i(!0);let r=await c.Ay.delete("/detalles/".concat(e));return await g(x),r.data}catch(e){throw console.error("Error al eliminar producto del carrito:",e),m("No se pudo eliminar el producto del carrito"),e}finally{i(!1)}},j=async()=>{if(x)try{i(!0);let e=await c.Ay.delete("/detalles/carrito/".concat(x));return l([]),u(0),e.data}catch(e){throw console.error("Error al vaciar el carrito:",e),m("No se pudo vaciar el carrito"),e}finally{i(!1)}},v=a.reduce((e,r)=>e+r.cantidad,0);return(0,t.jsx)(s.Provider,{value:{items:a,loading:n,error:d,total:h,cantidadTotal:v,carritoId:x,agregarProducto:y,actualizarCantidad:f,eliminarProducto:b,vaciarCarrito:j,cargarItemsCarrito:g},children:r})}},5838:(e,r,a)=>{"use strict";a.d(r,{Ay:()=>n,Ts:()=>l,rF:()=>s});var t=a(2651);let o=a(2818).env.REACT_APP_API_URL||"http://localhost:5000/api",c=t.A.create({baseURL:o,headers:{"Content-Type":"application/json"}}),s={getAll:async()=>{try{return(await c.get("/marcas")).data}catch(e){throw console.error("Error al obtener marcas:",e),e}},getById:async e=>{try{return(await c.get("/marcas/".concat(e))).data}catch(r){throw console.error("Error al obtener marca ".concat(e,":"),r),r}},create:async e=>{try{let r=new FormData;return Object.keys(e).forEach(a=>{"logo"===a&&e[a]instanceof File?r.append(a,e[a]):null!==e[a]&&void 0!==e[a]&&r.append(a,e[a])}),(await t.A.post("".concat(o,"/marcas"),r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){throw console.error("Error al crear marca:",e),e}},update:async(e,r)=>{try{let a=new FormData;return Object.keys(r).forEach(e=>{"logo"===e&&r[e]instanceof File?a.append(e,r[e]):null!==r[e]&&void 0!==r[e]&&a.append(e,r[e])}),console.log("Enviando datos de marca:",Object.fromEntries(a)),(await t.A.put("".concat(o,"/marcas/").concat(e),a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Error al actualizar marca ".concat(e,":"),r),r.response&&console.error("Respuesta del servidor:",r.response.data),r}},delete:async e=>{try{return(await c.delete("/marcas/".concat(e))).data}catch(r){throw console.error("Error al eliminar marca ".concat(e,":"),r),r}}},l={getAll:async()=>{try{return(await c.get("/productos?includeDetails=true")).data}catch(e){throw console.error("Error al obtener productos:",e),e}},getById:async e=>{try{return(await c.get("/productos/".concat(e))).data}catch(r){throw console.error("Error al obtener producto ".concat(e,":"),r),r}},getByMarca:async e=>{try{return(await c.get("/productos/marca/".concat(e))).data}catch(r){throw console.error("Error al obtener productos de marca ".concat(e,":"),r),r}},create:async e=>{try{let r=new FormData;return Object.keys(e).forEach(a=>{"imagen"===a&&e[a]instanceof File?r.append(a,e[a]):null!==e[a]&&void 0!==e[a]&&r.append(a,e[a])}),(await t.A.post("".concat(o,"/productos"),r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){throw console.error("Error al crear producto:",e),e}},update:async(e,r)=>{try{let a=new FormData;return Object.keys(r).forEach(e=>{"imagen"===e&&r[e]instanceof File?a.append(e,r[e]):null!==r[e]&&void 0!==r[e]&&a.append(e,r[e])}),(await t.A.put("".concat(o,"/productos/").concat(e),a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Error al actualizar producto ".concat(e,":"),r),r}},delete:async e=>{try{return(await c.delete("/productos/".concat(e))).data}catch(r){throw console.error("Error al eliminar producto ".concat(e,":"),r),r}}},n=c},1372:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>d});var t=a(5155),o=a(2115),c=a(8173),s=a.n(c),l=a(9076),n=a(8725),i=a(2818);let d=()=>{let{items:e,loading:r,error:a,total:c,cantidadTotal:d,actualizarCantidad:m,eliminarProducto:h,vaciarCarrito:u}=(0,n.u)(),[x,p]=(0,o.useState)(!1),g=e=>null==e?"0.00":Number(e).toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}),y=async(e,r,a)=>{let t=a+r;if(!(t<1))try{await m(e,t)}catch(e){}},f=async e=>{try{await h(e)}catch(e){}},b=async()=>{try{await u()}catch(e){}},j=i.env.NEXT_PUBLIC_API_URL||"http://localhost:5000";return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-950 text-white",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-gray-900 to-black py-8 border-b border-gray-800",children:(0,t.jsx)("div",{className:"container mx-auto px-4",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,t.jsxs)("h1",{className:"text-3xl md:text-4xl font-bold flex items-center gap-3 mb-4 md:mb-0",children:[(0,t.jsx)(l.AsH,{className:"text-red-500"}),(0,t.jsxs)("span",{children:["Mi ",(0,t.jsx)("span",{className:"text-red-500",children:"Carrito"})," de Compras"]})]}),(0,t.jsxs)(s(),{href:"/",className:"flex items-center gap-2 text-gray-400 hover:text-red-500 transition-colors duration-300",children:[(0,t.jsx)(l.QVr,{}),(0,t.jsx)("span",{children:"Continuar comprando"})]})]})})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:r?(0,t.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-red-500"})}):a?(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)("p",{className:"text-red-500 text-xl mb-4",children:a}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Reintentar"})]}):0===e.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-16",children:[(0,t.jsx)("div",{className:"text-8xl text-gray-800 mb-6",children:(0,t.jsx)(l.AsH,{})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Tu carrito est\xe1 vac\xedo"}),(0,t.jsx)("p",{className:"text-gray-400 text-center max-w-md mb-8",children:"Parece que a\xfan no has agregado productos a tu carrito. Descubre nuestras incre\xedbles ofertas y encuentra el equipo gaming perfecto para ti."}),(0,t.jsx)(s(),{href:"/catalogo",className:"px-8 py-3 bg-gradient-to-r from-red-600 to-red-500 hover:from-red-500 hover:to-red-600 text-white font-semibold rounded-lg transition-all duration-300 hover:shadow-lg hover:shadow-red-600/30",children:"Ver productos destacados"})]}):(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:[(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4 p-4 bg-gray-800/50 border-b border-gray-800 text-sm font-medium text-gray-400",children:[(0,t.jsx)("div",{className:"col-span-6 md:col-span-6",children:"Producto"}),(0,t.jsx)("div",{className:"col-span-2 md:col-span-2 text-center",children:"Precio"}),(0,t.jsx)("div",{className:"col-span-2 md:col-span-2 text-center",children:"Cantidad"}),(0,t.jsx)("div",{className:"col-span-2 md:col-span-2 text-right",children:"Total"})]}),(0,t.jsx)("div",{className:"divide-y divide-gray-800",children:e.map(e=>(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4 p-4 items-center",children:[(0,t.jsxs)("div",{className:"col-span-6 md:col-span-6 flex gap-3",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-800 rounded-md overflow-hidden flex-shrink-0",children:e.imagen?(0,t.jsx)("img",{src:"".concat(j).concat(e.imagen),alt:e.nombre,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:"Sin imagen"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-white font-medium line-clamp-1",children:e.nombre}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:e.marca_nombre||"Sin marca"}),(0,t.jsxs)("button",{onClick:()=>f(e.id_detalle_carrito),className:"text-xs text-red-500 hover:text-red-400 flex items-center gap-1 mt-1",children:[(0,t.jsx)(l.qbC,{size:10}),(0,t.jsx)("span",{children:"Eliminar"})]})]})]}),(0,t.jsx)("div",{className:"col-span-2 md:col-span-2 text-center",children:(0,t.jsxs)("span",{className:"text-white",children:["$",g(e.precio_unitario)]})}),(0,t.jsx)("div",{className:"col-span-2 md:col-span-2 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("button",{onClick:()=>y(e.id_detalle_carrito,-1,e.cantidad),className:"w-7 h-7 flex items-center justify-center bg-gray-800 text-gray-300 rounded hover:bg-gray-700 transition-colors",children:(0,t.jsx)(l.iu5,{size:10})}),(0,t.jsx)("span",{className:"text-white w-6 text-center",children:e.cantidad}),(0,t.jsx)("button",{onClick:()=>y(e.id_detalle_carrito,1,e.cantidad),className:"w-7 h-7 flex items-center justify-center bg-gray-800 text-gray-300 rounded hover:bg-gray-700 transition-colors",children:(0,t.jsx)(l.OiG,{size:10})})]})}),(0,t.jsx)("div",{className:"col-span-2 md:col-span-2 text-right",children:(0,t.jsxs)("span",{className:"text-white font-medium",children:["$",g(e.total)]})})]},e.id_detalle_carrito))})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("button",{onClick:b,className:"px-4 py-2 border border-gray-700 text-gray-300 rounded-lg hover:bg-gray-800 transition-colors",children:"Vaciar carrito"}),(0,t.jsx)(s(),{href:"/",className:"text-gray-400 hover:text-red-500 transition-colors",children:"Seguir comprando"})]})]}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-6 sticky top-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4 pb-4 border-b border-gray-800",children:"Resumen de compra"}),(0,t.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,t.jsxs)("div",{className:"flex justify-between text-gray-400",children:[(0,t.jsxs)("span",{children:["Subtotal (",d," productos):"]}),(0,t.jsxs)("span",{className:"text-white",children:["$",g(c)]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-gray-400",children:[(0,t.jsx)("span",{children:"Env\xedo:"}),(0,t.jsx)("span",{className:"text-white",children:"Gratis"})]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-lg font-bold mb-6 pt-4 border-t border-gray-800",children:[(0,t.jsx)("span",{children:"Total:"}),(0,t.jsxs)("span",{className:"text-red-500",children:["$",g(c)]})]}),(0,t.jsx)("button",{onClick:()=>{p(!0),setTimeout(()=>{p(!1),window.location.href="/checkout"},1500)},disabled:x,className:"w-full py-3 bg-gradient-to-r from-red-600 to-red-500 hover:from-red-500 hover:to-red-600 text-white font-semibold rounded-lg transition-all duration-300 hover:shadow-lg hover:shadow-red-600/30 flex items-center justify-center",children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"animate-spin h-5 w-5 mr-2 border-t-2 border-white rounded-full"}),"Procesando..."]}):"Proceder al pago"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Los precios y la disponibilidad est\xe1n sujetos a cambios. El carrito se considera un documento sin valor contractual."})]})})]})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[504,532,651,441,517,358],()=>r(6534)),_N_E=e.O()}]);